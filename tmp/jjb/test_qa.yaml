- scm:
    name: qa-python-scm
    scm:
      - git:
          url: git@github.com:bimboterminator/course_project.git
          credentials-id: b83190f0-fee5-4e3a-857c-0520180c2ca9
          basedir: src/
          branches:
            - master

- job:
    name: project_fv1
    description: "Project\n"
    project-type: freestyle

    scm:
      - qa-python-scm

    wrappers:
      - timestamps
      - workspace-cleanup

    triggers:
      - pollscm:
          cron: '* * * * *'

    builders:
      - shell: |
          mkdir -p $WORKSPACE/allure-results
          docker-compose up -d
          cd "src/code/"
          docker run -d --name testing -v src/code/:/code -v src/tmp/:/tmp --net my-network pytests:latest --selenoid htttp://localhost:4444/wb/hub tests -m UI
          docker rm - f testing
          docker run -d --name testing -v src/code/:/code -v src/tmp/:/tmp --net my-network pytests:latest
          docker-compose down

    publishers:
      - allure:
          results-path:
            - path: allure-results
          report-build-policy: ALWAYS